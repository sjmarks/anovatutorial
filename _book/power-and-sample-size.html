<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Part 4 Power and Sample Size | 1-Way ANOVA- Model Representations, Power, and Sample Size Tutorial</title>
  <meta name="description" content="This is a 1-way ANOVA tutorial built with bookdown." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Part 4 Power and Sample Size | 1-Way ANOVA- Model Representations, Power, and Sample Size Tutorial" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a 1-way ANOVA tutorial built with bookdown." />
  <meta name="github-repo" content="sjmarks/anovatutorial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Part 4 Power and Sample Size | 1-Way ANOVA- Model Representations, Power, and Sample Size Tutorial" />
  
  <meta name="twitter:description" content="This is a 1-way ANOVA tutorial built with bookdown." />
  

<meta name="author" content="Simon Marks" />


<meta name="date" content="2020-06-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="meanseffects.html"/>
<link rel="next" href="check-in-answers.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">1-Way ANOVA Tutorial</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>2</b> ANOVA Basics</a><ul>
<li class="chapter" data-level="2.1" data-path="basics.html"><a href="basics.html#check-in"><i class="fa fa-check"></i><b>2.1</b> Check-in</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="meanseffects.html"><a href="meanseffects.html"><i class="fa fa-check"></i><b>3</b> The Means and Effects Models</a><ul>
<li class="chapter" data-level="3.1" data-path="meanseffects.html"><a href="meanseffects.html#bookkeep"><i class="fa fa-check"></i><b>3.1</b> ANOVA Bookkeeping</a></li>
<li class="chapter" data-level="3.2" data-path="meanseffects.html"><a href="meanseffects.html#means-model"><i class="fa fa-check"></i><b>3.2</b> Means Model</a><ul>
<li class="chapter" data-level="3.2.1" data-path="meanseffects.html"><a href="meanseffects.html#employing-the-means-model-to-do-1-way-anova-in-r"><i class="fa fa-check"></i><b>3.2.1</b> Employing the Means Model to do 1-way ANOVA in R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="meanseffects.html"><a href="meanseffects.html#effects-model"><i class="fa fa-check"></i><b>3.3</b> Effects Model</a><ul>
<li class="chapter" data-level="3.3.1" data-path="meanseffects.html"><a href="meanseffects.html#employing-the-effects-model-to-do-1-way-anova-in-r"><i class="fa fa-check"></i><b>3.3.1</b> Employing the Effects Model to do 1-way ANOVA in R</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="meanseffects.html"><a href="meanseffects.html#check-in-1"><i class="fa fa-check"></i><b>3.4</b> Check-in</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html"><i class="fa fa-check"></i><b>4</b> Power and Sample Size</a><ul>
<li class="chapter" data-level="4.1" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html#power"><i class="fa fa-check"></i><b>4.1</b> Power</a></li>
<li class="chapter" data-level="4.2" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html#playing-with-sample-size"><i class="fa fa-check"></i><b>4.2</b> Playing with Sample Size</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="check-in-answers.html"><a href="check-in-answers.html"><i class="fa fa-check"></i><b>5</b> Check-in Answers</a><ul>
<li class="chapter" data-level="5.1" data-path="check-in-answers.html"><a href="check-in-answers.html#part-2"><i class="fa fa-check"></i><b>5.1</b> Part 2</a></li>
<li class="chapter" data-level="5.2" data-path="check-in-answers.html"><a href="check-in-answers.html#part-3"><i class="fa fa-check"></i><b>5.2</b> Part 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">1-Way ANOVA- Model Representations, Power, and Sample Size Tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="power-and-sample-size" class="section level1">
<h1><span class="header-section-number">Part 4</span> Power and Sample Size</h1>
<p>The F-statistic we obtained from our <code>insectSprays</code> example was so large that we assumed it was a statistically significant result. Of course in practice we would conduct a formal hypothesis test and invoke a null F-distribution to test statistical significance. For our <strong>effects</strong> model we put together for <code>insectSprays</code> we would pose the following null and alternative hypotheses:</p>
<ul>
<li><span class="math inline">\(H_{0}\)</span>: The type of spray <strong>has no effect</strong> on insect count in the population of all insect plots.</li>
<li><span class="math inline">\(H_{a}\)</span>: The type of spray <strong>has an effect</strong> on insect count in the population of all insect plots.</li>
</ul>
<p>We can plot the null <strong>F(5, 66)</strong> distribution in R:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">insects_F &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="ot">NULL</span>, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">35</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> df, <span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>,</a>
<a class="sourceLine" id="cb15-3" title="3">    <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">df1 =</span> <span class="dv">5</span>, <span class="dt">df2 =</span> <span class="dv">66</span>), <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;F&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Density&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> df, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">df1 =</span> <span class="dv">5</span>, <span class="dt">df2 =</span> <span class="dv">66</span>),</a>
<a class="sourceLine" id="cb15-8" title="8">    <span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>,</a>
<a class="sourceLine" id="cb15-9" title="9">    <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>,</a>
<a class="sourceLine" id="cb15-10" title="10">    <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="kw">qf</span>(<span class="dt">p =</span> <span class="fl">0.99</span>, <span class="dt">df1 =</span> <span class="dv">5</span>, <span class="dt">df2 =</span> <span class="dv">66</span>), <span class="dv">35</span>)</a>
<a class="sourceLine" id="cb15-11" title="11">  ) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">qf</span>(<span class="dt">p =</span> <span class="fl">0.99</span>, <span class="dt">df1 =</span> <span class="dv">5</span>, <span class="dt">df2 =</span> <span class="dv">66</span>), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">34.7</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:insects-F-stat"></span>
<img src="anova-tutorial_files/figure-html/insects-F-stat-1.png" alt="Null F-distribution with a numerator df = 5 and denominator df = 66. The dark blue shaded area demarcated by the solid red line represents the the critical F-statistic value at which to reject our null hypotheis at the 0.01 significance level. Our obtained F-statistic (black dashed line) clearly exceeds this threshold!" width="672" />
<p class="caption">
Figure 4.1: Null F-distribution with a numerator df = 5 and denominator df = 66. The dark blue shaded area demarcated by the solid red line represents the the critical F-statistic value at which to reject our null hypotheis at the 0.01 significance level. Our obtained F-statistic (black dashed line) clearly exceeds this threshold!
</p>
</div>
<p><strong>F(5, 66) = 34.7 with p-value &lt;0.0001</strong></p>
<p>I’d say we were pretty safe to assume what what we did in Part <a href="meanseffects.html#meanseffects">3</a> (essentially we rejected the null hypothesis posed above) just from glancing at the size of our computed F-statistic.</p>
<p>Our <code>insectSprays</code> example lended itself pretty darn well to getting a statistically significant F-statistic. A worthwhile question to ask if we were setting up our own experimental design outside of this example would be:</p>
<p><em><strong>How can we design our experiment to increase our chances of getting a statistically significant F-statistic?</strong></em></p>
<div id="power" class="section level2">
<h2><span class="header-section-number">4.1</span> Power</h2>
<p>The answer to the above question can be answered by thinking about <strong>power</strong>. Power is the probability that we reject our null hypothesis when in fact the null hypothesis is actually false <span class="citation">(Oehlert <a href="#ref-oehlert2010" role="doc-biblioref">2010</a>)</span>. To make sense of this recall the Type I error and Type II error rates from introductory statistics:</p>
<ul>
<li>Type I Error Rate: Probability that we reject our null hypothesis when it is in fact the null is true</li>
<li>Type II Error Rate: Probabilility that we fail to reject the null hypothesis when in fact the null is false</li>
</ul>
<p>Power represents the probability of the “correct” decision between these two errors rates. To determine power in the context of 1-way ANOVA we can plot both the central (null) and non-central F-distributions. The central F-distribution (an example is <a href="power-and-sample-size.html#fig:insects-F-stat">4.1</a>) shows the distribution of F-statistics when our null hypothesis is actually true. On the other hand, the non-central F-distribution shows the distribution of F-statistics when the the null hypothesis is actually false. The shape of the non-central F-distribution is dictated by a non-centrality parameter, viz.,</p>
<p><span class="math display">\[NCP = \frac{\sum n_{i}\tau_{i}^2}{\sigma^2}\]</span></p>
<p>We can estimate <span class="math inline">\(\tau_{i}^2\)</span> as the effect of the <span class="math inline">\(ith\)</span> treatment group, <span class="math inline">\(n_{i}\)</span> as the sample size (replicates) per treatment group, and <span class="math inline">\(\sigma^2\)</span> as mean square error (MSE). To illustrate how the central and non-central F-distributions are used to determine power, let us look at a situation where we modify our beloved <code>insectSprays</code> example.</p>
<p>Suppose we wanted to determine power for an ANOVA F-test for a new insecticide study we were planning with the following assumptions:</p>
<ul>
<li>Our level of significance is <span class="math inline">\(\alpha = 0.05\)</span></li>
<li>We will have three treatment groups (3 sprays) with 10 insect plots per treatment</li>
<li>Our MSE will be 2 insects</li>
<li>We assume the true mean change in insect count for the treatments will be <span class="math inline">\(\mu_{1} = 4\)</span>, <span class="math inline">\(\mu_{2} = 5\)</span>, and <span class="math inline">\(\mu_{3} = 6\)</span></li>
</ul>
<p>We plot our central and non-central F-distributions to calculate power for the ANOVA F-test (<span class="math inline">\(H_{0}\)</span>: <span class="math inline">\(\mu_{1}\)</span> = <span class="math inline">\(\mu_{2}\)</span> = <span class="math inline">\(\mu_{3}\)</span>). To plot the latter distribution we need to compute our non-centrality parameter:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">group_means &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb16-2" title="2">grand_mean &lt;-<span class="st"> </span><span class="kw">mean</span>(group_means)</a>
<a class="sourceLine" id="cb16-3" title="3">ncp_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span>((group_means[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>grand_mean)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(group_means[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>grand_mean)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(group_means[<span class="dv">3</span>] <span class="op">-</span><span class="st"> </span>grand_mean)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb16-4" title="4">ncp_<span class="dv">1</span></a></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>Plotting our distributions:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">example_power_fdists &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="ot">NULL</span>, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">15</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="st">  </span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="st">  </span><span class="co"># Null F-distribution F(2, 27, 0)</span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> df, <span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>,</a>
<a class="sourceLine" id="cb18-5" title="5">    <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">df1 =</span> <span class="dv">2</span>, <span class="dt">df2 =</span> <span class="dv">27</span>, <span class="dt">ncp =</span> <span class="dv">0</span>), <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="st">  </span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="st">  </span><span class="co"># Non-central F-distribution F (2, 27, 10)</span></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> df, <span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;yellow&quot;</span>,</a>
<a class="sourceLine" id="cb18-9" title="9">    <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">df1 =</span> <span class="dv">2</span>, <span class="dt">df2 =</span> <span class="dv">27</span>, <span class="dt">ncp =</span> ncp_<span class="dv">1</span>), <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="st">  </span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="st">  </span><span class="co"># Power</span></a>
<a class="sourceLine" id="cb18-12" title="12"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> df, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">df1 =</span> <span class="dv">2</span>, <span class="dt">df2 =</span> <span class="dv">27</span>, <span class="dt">ncp =</span> ncp_<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb18-13" title="13">    <span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb18-14" title="14">    <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="kw">qf</span>(<span class="dt">p =</span> <span class="kw">pf</span>(<span class="kw">qf</span>(<span class="fl">0.95</span>, <span class="dv">2</span>, <span class="dv">27</span>), <span class="dv">2</span>, <span class="dv">27</span>, <span class="dt">ncp =</span> ncp_<span class="dv">1</span>, <span class="dt">lower.tail =</span> F), </a>
<a class="sourceLine" id="cb18-15" title="15">                <span class="dt">df1 =</span> <span class="dv">2</span>, <span class="dt">df2 =</span> <span class="dv">27</span>, <span class="dt">ncp =</span> ncp_<span class="dv">1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>), <span class="dv">20</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-16" title="16"><span class="st">  </span></a>
<a class="sourceLine" id="cb18-17" title="17"><span class="st">  </span><span class="co"># F-critical value (alpha = 0.05)</span></a>
<a class="sourceLine" id="cb18-18" title="18"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">qf</span>(<span class="dt">p =</span> <span class="fl">0.95</span>, <span class="dt">df1 =</span> <span class="dv">2</span>, <span class="dt">df2 =</span> <span class="dv">27</span>), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-19" title="19"><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-20" title="20"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Density&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-21" title="21"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;F&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:ex-power-fdists"></span>
<img src="anova-tutorial_files/figure-html/ex-power-fdists-1.png" alt="Plotted F (2, 27, 0) and F(2, 27, 10) distributions (represented by the blue and yellow/green shadings respectively). The power of our ANOVA F-test is the shaded green area of the non-central F-distribution to the right of the red-dashed line." width="672" />
<p class="caption">
Figure 4.2: Plotted F (2, 27, 0) and F(2, 27, 10) distributions (represented by the blue and yellow/green shadings respectively). The power of our ANOVA F-test is the shaded green area of the non-central F-distribution to the right of the red-dashed line.
</p>
</div>
<p>Our power is the <span style="color: green;">green</span> shaded area, the density of upper tail of the non-central F (2, 27, 10) past the critical F-statistic corresponding to our chosen level of significance. We can calculate this formally in R:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">pf</span>(<span class="kw">qf</span>(<span class="fl">0.95</span>, <span class="dv">2</span>, <span class="dv">27</span>), <span class="dv">2</span>, <span class="dv">27</span>, <span class="dt">ncp =</span> ncp_<span class="dv">1</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## [1] 0.7673536</code></pre>
</div>
<div id="playing-with-sample-size" class="section level2">
<h2><span class="header-section-number">4.2</span> Playing with Sample Size</h2>
<p>The non-centrality parameter is ultimately what controls the power of our statistical test. The larger the non-centrality parameter, the larger the power. We can deduce from the non-centrality parameter formula that we can change it by:</p>
<ol style="list-style-type: decimal">
<li>Changing the sample size in our experimental design</li>
<li>Changing our treatment group effect sizes</li>
<li>Changing our MSE (within treatment group variance)</li>
</ol>
<p>In practice, changing sample size is probably the easiest way to tweak power. The below animation illustrates how the non-centrality parameter and power change with different sample sizes if we keep everything else the same as specified in our above example for calculating power.</p>
<div class="figure"><span id="fig:flowchart"></span>
<img src="power_animation.gif" alt="Animation showing the change in power with increasing sample size. The different shades of green represent the changing amounts of power."  />
<p class="caption">
Figure 4.3: Animation showing the change in power with increasing sample size. The different shades of green represent the changing amounts of power.
</p>
</div>
<p>The graphic adds respective F-distributions and probabilites in order of increasing sample size. The first set of layers correspond to a sample size of 5 replicates per treatment (15 total plots), the next set correspond to 10 per treatment (30 total plots), and the last set correspond to 15 per treatment (45 total plots). Pay attention to the green shaded areas in the graphic, this represents the power in each of our three scenarios with different sample size. The yellow shaded area (non-central F-distribution) widens with increasing sample size leading to higher power!</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-oehlert2010">
<p>Oehlert, Gary W. 2010. <em>A First Course in Design and Analysis of Experiments</em>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="meanseffects.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="check-in-answers.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["anova-tutorial.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
